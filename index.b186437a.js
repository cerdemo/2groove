let e,t,o;var n=globalThis,r={},i={},a=n.parcelRequirefc44;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var o={id:e,exports:{}};return r[e]=o,t.call(o.exports,o,o.exports),o.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){i[e]=t},n.parcelRequirefc44=a);var c=a.register;c("27Lyk",function(e,t){Object.defineProperty(e.exports,"register",{get:()=>o,set:e=>o=e,enumerable:!0,configurable:!0});var o,n=new Map;o=function(e,t){for(var o=0;o<t.length-1;o+=2)n.set(t[o],{baseUrl:e,path:t[o+1]})}}),c("lw8Mu",function(e,t){e.exports=new URL("closed-hihat_1.c3598e64.mp3",import.meta.url).toString()}),c("1NuFb",function(e,t){e.exports=new URL("closed-hihat_2.df9c6d68.mp3",import.meta.url).toString()}),c("e3CPn",function(e,t){e.exports=new URL("closed-hihat_3.2e25a9fb.mp3",import.meta.url).toString()}),c("j8xcP",function(e,t){e.exports=new URL("closed-hihat_4.546f9296.mp3",import.meta.url).toString()}),c("dfk0E",function(e,t){e.exports=new URL("closed-hihat_5.84f49b25.mp3",import.meta.url).toString()}),c("1WnZU",function(e,t){e.exports=new URL("closed-hihat_6.583c3a3d.mp3",import.meta.url).toString()}),c("1ITJB",function(e,t){e.exports=new URL("closed-hihat_7.769c6d06.mp3",import.meta.url).toString()}),c("570Mo",function(e,t){e.exports=new URL("closed-hihat_8.6911f924.mp3",import.meta.url).toString()}),c("amPri",function(e,t){e.exports=new URL("closed-hihat_9.8e0b0ab6.mp3",import.meta.url).toString()}),c("fAaYz",function(e,t){e.exports=new URL("closed-hihat_10.51d068e3.mp3",import.meta.url).toString()}),c("fPRLW",function(e,t){e.exports=new URL("closed-hihat_11.8cabb786.mp3",import.meta.url).toString()}),c("kwhgF",function(e,t){e.exports=new URL("closed-hihat_12.b1e4a2bf.mp3",import.meta.url).toString()}),c("e0iWv",function(e,t){e.exports=new URL("open-hihat_1.1fa9c461.mp3",import.meta.url).toString()}),c("l6Y43",function(e,t){e.exports=new URL("open-hihat_2.2f935a0f.mp3",import.meta.url).toString()}),c("fBSj4",function(e,t){e.exports=new URL("open-hihat_3.ed4ec909.mp3",import.meta.url).toString()}),c("ajKwd",function(e,t){e.exports=new URL("open-hihat_4.5364cb46.mp3",import.meta.url).toString()}),c("ck7JE",function(e,t){e.exports=new URL("open-hihat_5.14edd338.mp3",import.meta.url).toString()}),c("hnHVd",function(e,t){e.exports=new URL("open-hihat_6.0efdc832.mp3",import.meta.url).toString()}),c("aA3m4",function(e,t){e.exports=new URL("open-hihat_7.f7c80852.mp3",import.meta.url).toString()}),c("8a69x",function(e,t){e.exports=new URL("open-hihat_8.e6bbdeff.mp3",import.meta.url).toString()}),c("dqHjm",function(e,t){e.exports=new URL("open-hihat_9.ce51d058.mp3",import.meta.url).toString()}),c("jnTsG",function(e,t){e.exports=new URL("open-hihat_10.4ec7a4eb.mp3",import.meta.url).toString()}),c("c1zb3",function(e,t){e.exports=new URL("open-hihat_11.0bc90e96.mp3",import.meta.url).toString()}),c("26IF6",function(e,t){e.exports=new URL("open-hihat_12.a95c984b.mp3",import.meta.url).toString()}),c("lbiIu",function(e,t){e.exports=new URL("crash_1.6aa3010b.mp3",import.meta.url).toString()}),c("2NGyf",function(e,t){e.exports=new URL("crash_2.ad19f12b.mp3",import.meta.url).toString()}),c("lABIk",function(e,t){e.exports=new URL("crash_3.8ba5b29e.mp3",import.meta.url).toString()}),c("3iUw5",function(e,t){e.exports=new URL("crash_4.a17a8a67.mp3",import.meta.url).toString()}),c("274PA",function(e,t){e.exports=new URL("crash_5.8b1d5604.mp3",import.meta.url).toString()}),c("7ehjG",function(e,t){e.exports=new URL("crash_6.9dcf9ed6.mp3",import.meta.url).toString()}),c("9N1z7",function(e,t){e.exports=new URL("crash_7.6a40b51c.mp3",import.meta.url).toString()}),c("71k2j",function(e,t){e.exports=new URL("crash_8.99d0fd8d.mp3",import.meta.url).toString()}),c("5Pvi2",function(e,t){e.exports=new URL("crash_9.4b8594d9.mp3",import.meta.url).toString()}),c("2RFd4",function(e,t){e.exports=new URL("crash_10.0d7efbff.mp3",import.meta.url).toString()}),c("1eKy2",function(e,t){e.exports=new URL("crash_11.cd2e80a9.mp3",import.meta.url).toString()}),c("8YECZ",function(e,t){e.exports=new URL("crash_12.4ad8210f.mp3",import.meta.url).toString()}),c("5SxuK",function(e,t){e.exports=new URL("ride_1.b04f8857.mp3",import.meta.url).toString()}),c("ldQTA",function(e,t){e.exports=new URL("ride_2.1e254981.mp3",import.meta.url).toString()}),c("f6Cx3",function(e,t){e.exports=new URL("ride_3.506fe573.mp3",import.meta.url).toString()}),c("dWpbb",function(e,t){e.exports=new URL("ride_4.f8c46940.mp3",import.meta.url).toString()}),c("hhn9f",function(e,t){e.exports=new URL("ride_5.9eedc3c5.mp3",import.meta.url).toString()}),c("ZdGiJ",function(e,t){e.exports=new URL("ride_6.6119b558.mp3",import.meta.url).toString()}),c("j9z4h",function(e,t){e.exports=new URL("ride_7.05f04bb8.mp3",import.meta.url).toString()}),c("kiJCK",function(e,t){e.exports=new URL("ride_8.e0a39ea5.mp3",import.meta.url).toString()}),c("272cE",function(e,t){e.exports=new URL("ride_9.b606a5a3.mp3",import.meta.url).toString()}),c("bTlbG",function(e,t){e.exports=new URL("ride_10.c4914e82.mp3",import.meta.url).toString()}),c("6CR9H",function(e,t){e.exports=new URL("ride_11.657bdea3.mp3",import.meta.url).toString()}),c("1Ltew",function(e,t){e.exports=new URL("ride_12.b86f4115.mp3",import.meta.url).toString()}),c("6bXMG",function(e,t){e.exports=new URL("kick_1.6d75be8e.mp3",import.meta.url).toString()}),c("1v8uQ",function(e,t){e.exports=new URL("kick_2.eef489eb.mp3",import.meta.url).toString()}),c("1gWYQ",function(e,t){e.exports=new URL("kick_3.d59afb9a.mp3",import.meta.url).toString()}),c("7GIzt",function(e,t){e.exports=new URL("kick_4.b6aa1d5a.mp3",import.meta.url).toString()}),c("46MCu",function(e,t){e.exports=new URL("kick_5.5a4a1577.mp3",import.meta.url).toString()}),c("56E5k",function(e,t){e.exports=new URL("kick_6.1b1aa317.mp3",import.meta.url).toString()}),c("2nfIT",function(e,t){e.exports=new URL("kick_7.0e6a60bd.mp3",import.meta.url).toString()}),c("1vINS",function(e,t){e.exports=new URL("kick_8.a6e6cb22.mp3",import.meta.url).toString()}),c("feiA7",function(e,t){e.exports=new URL("kick_9.e90f0f7b.mp3",import.meta.url).toString()}),c("aQbil",function(e,t){e.exports=new URL("kick_10.2508647b.mp3",import.meta.url).toString()}),c("624Hq",function(e,t){e.exports=new URL("kick_11.ca60b639.mp3",import.meta.url).toString()}),c("fYSwK",function(e,t){e.exports=new URL("kick_12.183b69d7.mp3",import.meta.url).toString()}),c("awcGy",function(e,t){e.exports=new URL("snare_1.5e9b43b5.mp3",import.meta.url).toString()}),c("3sfcn",function(e,t){e.exports=new URL("snare_2.673c28c6.mp3",import.meta.url).toString()}),c("9KbLN",function(e,t){e.exports=new URL("snare_3.3b5c10f7.mp3",import.meta.url).toString()}),c("bSyUS",function(e,t){e.exports=new URL("snare_4.54b1f023.mp3",import.meta.url).toString()}),c("8KIwk",function(e,t){e.exports=new URL("snare_5.81e6e076.mp3",import.meta.url).toString()}),c("kdpRC",function(e,t){e.exports=new URL("snare_6.109bef8f.mp3",import.meta.url).toString()}),c("hjY08",function(e,t){e.exports=new URL("snare_7.a258b319.mp3",import.meta.url).toString()}),c("eM6M7",function(e,t){e.exports=new URL("snare_8.57c5e497.mp3",import.meta.url).toString()}),c("1SKcy",function(e,t){e.exports=new URL("snare_9.3d8c9482.mp3",import.meta.url).toString()}),c("j9hxR",function(e,t){e.exports=new URL("snare_10.b2b762b9.mp3",import.meta.url).toString()}),c("2NXPr",function(e,t){e.exports=new URL("snare_11.64dc3f03.mp3",import.meta.url).toString()}),c("gAz4G",function(e,t){e.exports=new URL("snare_12.7da1f5d8.mp3",import.meta.url).toString()}),c("aD9Um",function(e,t){e.exports=new URL("hi-tom_1.ded5f514.mp3",import.meta.url).toString()}),c("7IHL8",function(e,t){e.exports=new URL("hi-tom_2.8574ea96.mp3",import.meta.url).toString()}),c("lhP3B",function(e,t){e.exports=new URL("hi-tom_3.9438c9df.mp3",import.meta.url).toString()}),c("kqdlv",function(e,t){e.exports=new URL("hi-tom_4.928d7f59.mp3",import.meta.url).toString()}),c("5YpTq",function(e,t){e.exports=new URL("hi-tom_5.a339ccb1.mp3",import.meta.url).toString()}),c("9d0yB",function(e,t){e.exports=new URL("hi-tom_6.94994fbe.mp3",import.meta.url).toString()}),c("d38YH",function(e,t){e.exports=new URL("hi-tom_7.ee3ea907.mp3",import.meta.url).toString()}),c("hF6rJ",function(e,t){e.exports=new URL("hi-tom_8.38b2f80d.mp3",import.meta.url).toString()}),c("iQi5z",function(e,t){e.exports=new URL("hi-tom_9.5a2cd443.mp3",import.meta.url).toString()}),c("ifCLN",function(e,t){e.exports=new URL("hi-tom_10.dba10a8d.mp3",import.meta.url).toString()}),c("iRvZv",function(e,t){e.exports=new URL("hi-tom_11.de67cef1.mp3",import.meta.url).toString()}),c("75iiO",function(e,t){e.exports=new URL("hi-tom_12.f5d60938.mp3",import.meta.url).toString()}),c("6kBfN",function(e,t){e.exports=new URL("mid-tom_1.3fc809be.mp3",import.meta.url).toString()}),c("8hpbe",function(e,t){e.exports=new URL("mid-tom_2.6b59b8f0.mp3",import.meta.url).toString()}),c("iuitn",function(e,t){e.exports=new URL("mid-tom_3.17f1cc7f.mp3",import.meta.url).toString()}),c("ekqSg",function(e,t){e.exports=new URL("mid-tom_4.72bb4506.mp3",import.meta.url).toString()}),c("iULhj",function(e,t){e.exports=new URL("mid-tom_5.c1baf999.mp3",import.meta.url).toString()}),c("5iX8l",function(e,t){e.exports=new URL("mid-tom_6.f2fc805f.mp3",import.meta.url).toString()}),c("8itDX",function(e,t){e.exports=new URL("mid-tom_7.970248d0.mp3",import.meta.url).toString()}),c("2eaI0",function(e,t){e.exports=new URL("mid-tom_8.73bfd563.mp3",import.meta.url).toString()}),c("ls98q",function(e,t){e.exports=new URL("mid-tom_9.211b9f20.mp3",import.meta.url).toString()}),c("euiK4",function(e,t){e.exports=new URL("mid-tom_10.6a403e17.mp3",import.meta.url).toString()}),c("9HaM0",function(e,t){e.exports=new URL("mid-tom_11.58388abe.mp3",import.meta.url).toString()}),c("ge5lW",function(e,t){e.exports=new URL("mid-tom_12.bcd70088.mp3",import.meta.url).toString()}),c("4OwOj",function(e,t){e.exports=new URL("floor-tom_1.12e2e635.mp3",import.meta.url).toString()}),c("c29E2",function(e,t){e.exports=new URL("floor-tom_2.e6e78471.mp3",import.meta.url).toString()}),c("aq3tN",function(e,t){e.exports=new URL("floor-tom_3.49806c39.mp3",import.meta.url).toString()}),c("brntc",function(e,t){e.exports=new URL("floor-tom_4.a291815e.mp3",import.meta.url).toString()}),c("gUGe5",function(e,t){e.exports=new URL("floor-tom_5.090c6c58.mp3",import.meta.url).toString()}),c("awWFT",function(e,t){e.exports=new URL("floor-tom_6.e90de229.mp3",import.meta.url).toString()}),c("ftxH4",function(e,t){e.exports=new URL("floor-tom_7.68418ad4.mp3",import.meta.url).toString()}),c("3yq6D",function(e,t){e.exports=new URL("floor-tom_8.20433cf0.mp3",import.meta.url).toString()}),c("cwkqo",function(e,t){e.exports=new URL("floor-tom_9.f95e6621.mp3",import.meta.url).toString()}),c("7lfO5",function(e,t){e.exports=new URL("floor-tom_10.8525c2e8.mp3",import.meta.url).toString()}),c("8ab0Q",function(e,t){e.exports=new URL("floor-tom_11.58d9143f.mp3",import.meta.url).toString()}),c("6sqLW",function(e,t){e.exports=new URL("floor-tom_12.24ed6b48.mp3",import.meta.url).toString()}),a("27Lyk").register(new URL("",import.meta.url).toString(),JSON.parse('["g3LtT","index.b186437a.js","27RPn","closed-hihat_1.c3598e64.mp3","cpxBE","closed-hihat_2.df9c6d68.mp3","bEf6y","closed-hihat_3.2e25a9fb.mp3","hz2D1","closed-hihat_4.546f9296.mp3","lxeZx","closed-hihat_5.84f49b25.mp3","kFLJw","closed-hihat_6.583c3a3d.mp3","72vaF","closed-hihat_7.769c6d06.mp3","CMLMa","closed-hihat_8.6911f924.mp3","lzUbx","closed-hihat_9.8e0b0ab6.mp3","lXL2N","closed-hihat_10.51d068e3.mp3","amCq5","closed-hihat_11.8cabb786.mp3","2HUd2","closed-hihat_12.b1e4a2bf.mp3","3ClXy","open-hihat_1.1fa9c461.mp3","iQW2c","open-hihat_2.2f935a0f.mp3","d7oFT","open-hihat_3.ed4ec909.mp3","jcetE","open-hihat_4.5364cb46.mp3","7Gdj8","open-hihat_5.14edd338.mp3","95skG","open-hihat_6.0efdc832.mp3","kpaVg","open-hihat_7.f7c80852.mp3","ao88n","open-hihat_8.e6bbdeff.mp3","j1LpH","open-hihat_9.ce51d058.mp3","QNB9J","open-hihat_10.4ec7a4eb.mp3","489CK","open-hihat_11.0bc90e96.mp3","7LvUx","open-hihat_12.a95c984b.mp3","gXdak","crash_1.6aa3010b.mp3","9DcNa","crash_2.ad19f12b.mp3","k0tsl","crash_3.8ba5b29e.mp3","c0MhK","crash_4.a17a8a67.mp3","jVnI3","crash_5.8b1d5604.mp3","kxhjp","crash_6.9dcf9ed6.mp3","fwWtj","crash_7.6a40b51c.mp3","fRnJB","crash_8.99d0fd8d.mp3","5fY2q","crash_9.4b8594d9.mp3","1MKxR","crash_10.0d7efbff.mp3","k2oUc","crash_11.cd2e80a9.mp3","bC5AX","crash_12.4ad8210f.mp3","13aa4","ride_1.b04f8857.mp3","cZBN5","ride_2.1e254981.mp3","i6TIL","ride_3.506fe573.mp3","59ldi","ride_4.f8c46940.mp3","621AQ","ride_5.9eedc3c5.mp3","e6gYE","ride_6.6119b558.mp3","eFwVf","ride_7.05f04bb8.mp3","ceeRN","ride_8.e0a39ea5.mp3","9ftJd","ride_9.b606a5a3.mp3","fdrjq","ride_10.c4914e82.mp3","72TSA","ride_11.657bdea3.mp3","3KOWW","ride_12.b86f4115.mp3","2699t","kick_1.6d75be8e.mp3","6gWGR","kick_2.eef489eb.mp3","ke6mk","kick_3.d59afb9a.mp3","aUWlm","kick_4.b6aa1d5a.mp3","3G3Wu","kick_5.5a4a1577.mp3","ilWQC","kick_6.1b1aa317.mp3","7CUwr","kick_7.0e6a60bd.mp3","5gQbC","kick_8.a6e6cb22.mp3","i137T","kick_9.e90f0f7b.mp3","aFEUV","kick_10.2508647b.mp3","8OaP8","kick_11.ca60b639.mp3","1sn3b","kick_12.183b69d7.mp3","4sBJH","snare_1.5e9b43b5.mp3","6zKvu","snare_2.673c28c6.mp3","2FDGo","snare_3.3b5c10f7.mp3","9XPce","snare_4.54b1f023.mp3","iv9W4","snare_5.81e6e076.mp3","jVsDc","snare_6.109bef8f.mp3","aRTsm","snare_7.a258b319.mp3","epW8J","snare_8.57c5e497.mp3","dWtN8","snare_9.3d8c9482.mp3","appk9","snare_10.b2b762b9.mp3","jtGfM","snare_11.64dc3f03.mp3","5ZTYV","snare_12.7da1f5d8.mp3","3t4ZY","hi-tom_1.ded5f514.mp3","cGpkD","hi-tom_2.8574ea96.mp3","p88ov","hi-tom_3.9438c9df.mp3","huESR","hi-tom_4.928d7f59.mp3","lNGPD","hi-tom_5.a339ccb1.mp3","7F98S","hi-tom_6.94994fbe.mp3","5MZk0","hi-tom_7.ee3ea907.mp3","g425Q","hi-tom_8.38b2f80d.mp3","7ZXIl","hi-tom_9.5a2cd443.mp3","ioQxK","hi-tom_10.dba10a8d.mp3","ezG6N","hi-tom_11.de67cef1.mp3","1OK0v","hi-tom_12.f5d60938.mp3","1TINM","mid-tom_1.3fc809be.mp3","cnbHY","mid-tom_2.6b59b8f0.mp3","j8i6x","mid-tom_3.17f1cc7f.mp3","hGK9k","mid-tom_4.72bb4506.mp3","99LZb","mid-tom_5.c1baf999.mp3","ckMI1","mid-tom_6.f2fc805f.mp3","3fSyH","mid-tom_7.970248d0.mp3","5X6dl","mid-tom_8.73bfd563.mp3","lV4UW","mid-tom_9.211b9f20.mp3","1WsAw","mid-tom_10.6a403e17.mp3","jYoji","mid-tom_11.58388abe.mp3","c8zf2","mid-tom_12.bcd70088.mp3","cOCNL","floor-tom_1.12e2e635.mp3","20vWf","floor-tom_2.e6e78471.mp3","8Jp44","floor-tom_3.49806c39.mp3","9BfCB","floor-tom_4.a291815e.mp3","9jrRf","floor-tom_5.090c6c58.mp3","4xrKq","floor-tom_6.e90de229.mp3","25ZoB","floor-tom_7.68418ad4.mp3","3am9S","floor-tom_8.20433cf0.mp3","7Q71Z","floor-tom_9.f95e6621.mp3","aFjLJ","floor-tom_10.8525c2e8.mp3","9glTC","floor-tom_11.58d9143f.mp3","wU6WE","floor-tom_12.24ed6b48.mp3","csRZ8","workerAjax.6b1dfd8f.js","lsp70","A.1bc05b06.png","abxMS","B.873f0259.png"]'));// Author: Çağrı Erdem, 2023
// Description: Main bundler script for 2groove web app.
// import "./../styles/mainUI.css";
// ----------------------------
// ----------------------------
// Author: Çağrı Erdem, 2023
// Description: MIDI Drum Sampler for 2groove web app.
// import { delay, eq, reverb } from "./efx.js";
const m={"closed-hihat":[a("lw8Mu"),a("1NuFb"),a("e3CPn"),a("j8xcP"),a("dfk0E"),a("1WnZU"),a("1ITJB"),a("570Mo"),a("amPri"),a("fAaYz"),a("fPRLW"),a("kwhgF")],"open-hihat":[a("e0iWv"),a("l6Y43"),a("fBSj4"),a("ajKwd"),a("ck7JE"),a("hnHVd"),a("aA3m4"),a("8a69x"),a("dqHjm"),a("jnTsG"),a("c1zb3"),a("26IF6")],crash:[a("lbiIu"),a("2NGyf"),a("lABIk"),a("3iUw5"),a("274PA"),a("7ehjG"),a("9N1z7"),a("71k2j"),a("5Pvi2"),a("2RFd4"),a("1eKy2"),a("8YECZ")],ride:[a("5SxuK"),a("ldQTA"),a("f6Cx3"),a("dWpbb"),a("hhn9f"),a("ZdGiJ"),a("j9z4h"),a("kiJCK"),a("272cE"),a("bTlbG"),a("6CR9H"),a("1Ltew")],kick:[a("6bXMG"),a("1v8uQ"),a("1gWYQ"),a("7GIzt"),a("46MCu"),a("56E5k"),a("2nfIT"),a("1vINS"),a("feiA7"),a("aQbil"),a("624Hq"),a("fYSwK")],snare:[a("awcGy"),a("3sfcn"),a("9KbLN"),a("bSyUS"),a("8KIwk"),a("kdpRC"),a("hjY08"),a("eM6M7"),a("1SKcy"),a("j9hxR"),a("2NXPr"),a("gAz4G")],"hi-tom":[a("aD9Um"),a("7IHL8"),a("lhP3B"),a("kqdlv"),a("5YpTq"),a("9d0yB"),a("d38YH"),a("hF6rJ"),a("iQi5z"),a("ifCLN"),a("iRvZv"),a("75iiO")],"mid-tom":[a("6kBfN"),a("8hpbe"),a("iuitn"),a("ekqSg"),a("iULhj"),a("5iX8l"),a("8itDX"),a("2eaI0"),a("ls98q"),a("euiK4"),a("9HaM0"),a("ge5lW")],"floor-tom":[a("4OwOj"),a("c29E2"),a("aq3tN"),a("brntc"),a("gUGe5"),a("awWFT"),a("ftxH4"),a("3yq6D"),a("cwkqo"),a("7lfO5"),a("8ab0Q"),a("6sqLW")]},_={};["closed-hihat","open-hihat","crash","ride","kick","snare","hi-tom","mid-tom","floor-tom"].forEach(e=>{let t={};m[e].forEach((e,o)=>{let n=Tone.Frequency(60+o,"midi").toNote();t[n]=e}),_[e]=new Tone.Sampler({urls:t}).toDestination()});// Dict to map MIDI note number to the appropriate sample note
const s={C1:"kick",D1:"snare",F1:"floor-tom",B1:"mid-tom",C2:"hi-tom","C#2":"crash","D#2":"ride","F#1":"closed-hihat","A#1":"open-hihat"};// When processing MIDI data in software, developers often use conditional statements like if (status === 144) to check the type of MIDI message received and to handle it accordingly. 
// In this particular case, the software would execute specific logic for "Note On" messages on channel 1.
// The MIDI message is an array of integers. The first integer is the status byte, which contains the message type and the MIDI channel.
function p(e,t=!1){if(d){let[o,n,r]=e.data,i=Tone.Frequency(n-12,"midi").toNote(),a=s[i];if(t&&(// console.log(typeof noteName);
console.log(n,i,r),console.log("drumType: ",a)),144===o&&s[i]){// const drumType = drumMappings[noteName];
let e=Tone.Frequency(60+Math.ceil(r/Math.ceil(10.666666666666666))-1,"midi").toNote();// assume `velocity` is provided by MIDI
// console.log(`Drum type and note to trigger: ${drumType} ${noteToTrigger}`);
if(a){// Lookup the appropriate sampler using the drumType
let t=_[a];// Trigger the sound w/ a simple Attack-Release envelope TODO: Make better envelopes!
t.triggerAttackRelease(e,{"closed-hihat":"1n","open-hihat":"2n",crash:"1n",ride:"1n",kick:"8n",snare:"2n","hi-tom":"4n","mid-tom":"4n","floor-tom":"4n"}[a]);// sampler.chain(eq, delay, reverb); // EFX chain
}else console.error(`No mappings found for drum type: ${a}`)}}}// // WITH THE OLD UI:
//VARIABLES
// // Variable to keep track of the playback state
// let isListening = false;
// // Grab the button from the UI
// const toggleListeningButton = document.getElementById('togglePlaybackButton');
// //EVENT LISTENERS
// // Add an event listener to the button
// toggleListeningButton.addEventListener('click', toggleListening);
// // Handle button click
// function toggleListening() {
//     isListening = !isListening; // Toggle the listening state
//     // Update button text based on the current state // Note that we are not doing it anymore with the new GUI
//     // toggleListeningButton.textContent = isListening ? 'Stop Listening' : 'Start Listening';
//   }
//   if (navigator.requestMIDIAccess) { // request MIDI access
//     navigator.requestMIDIAccess().then(onMIDISuccess, onMIDIFailure);
//   } else {
//     console.error('WebMIDI is not supported in this browser.');
//   }
// WITH THE NEW UI:
// Instead of using the click event on the button, 
// we will use the change event on the checkbox (since that's what you have now).
// Instead of toggling button text (since there's no text now), 
// we'll toggle the checkbox's checked state.
// Variable to keep track of the playback state
let d=!1;// Grab the checkbox from the UI
const f=document.querySelector('#togglePlaybackButton input[type="checkbox"]');function l(e){console.error("Could not access MIDI devices:",e)}// NOTES:
//EVENT LISTENERS
// Add an event listener to the checkbox
f.addEventListener("change",// Handle checkbox state change
function(){d=f.checked;// Update listening state based on checkbox
}),navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(// Handle successful MIDI access
function e(t){let o=t.inputs.values();for(let e=o.next();e&&!e.done;e=o.next())e.value.onmidimessage=p;t.onstatechange=function(t){"connected"===t.port.state?t.port.onmidimessage=p:"disconnected"===t.port.state&&(t.port.onmidimessage=null,// Try to refresh MIDI connections after a short delay
setTimeout(()=>{navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(e,l):console.error("WebMIDI is not supported in this browser.")},1e3))}},l):console.error("WebMIDI is not supported in this browser.");// Uint8Array(3): This indicates the array contains three elements. MIDI messages typically consist of 1-3 bytes, so this is consistent with typical MIDI behavior.
// [128, 36, 0]: These are the actual values (in decimal) of the MIDI message:
// 128: This is the status byte. In MIDI, a value of 128 (0x80 in hexadecimal) typically corresponds to a "Note Off" message for channel 1.
// 36: This is the first data byte. For "Note On" and "Note Off" messages, this represents the MIDI note number. In this case, it's 36 which might correspond to a kick drum in a typical MIDI drum map.
// 0: This is the second data byte. For "Note On" and "Note Off" messages, this represents the velocity (or volume) of the note. A velocity of 0 for a "Note On" message is often treated as a "Note Off".
// buffer, byteLength, byteOffset, etc.: These are properties of the Uint8Array and provide information about the underlying buffer storage and the array's size. For most MIDI applications, you won't need to worry about these.
// For example, a MIDI message (128, 36, 0) can be interpreted as: "Note Off" for MIDI note 36 on channel 1 with a velocity of 0.
// Author: Çağrı Erdem, 2023
// Description: Defining a global state module to fetch MIDI (bytes) 
// data from the server and make it available to all modules of the 2groove web app.
const H={midiData:null,midiReadyForProcessing:!1,setMidiData(e){console.log("MIDI data received in bytes!",e),this.midiData=e,this.midiReadyForProcessing=!0},getMidiData(){return this.midiData},isMidiReadyForProcessing(){return this.midiReadyForProcessing},midiProcessed(){this.midiReadyForProcessing=!1;// Close the gate
}},u=new AudioContext,S=document.getElementById("tempo"),R=document.getElementById("metronomeVolume"),h=document.querySelector('#toggleMetronome input[type="checkbox"]'),E=document.getElementById("recIndicator"),g=document.getElementById("arrayList"),b=[];let A=!1,F=[],w=!1,L=0,x=0,k=[],U=!0,I=!1,T=.2,y=.3,v=1,M=1e3,D={strategy:["epsilon","softmax_temp"],tempRange:[[.01,10],[.1,2]],threshRange:[[.15,.35],[.1,.2]]},W=0;//////////////////////
// GLOBAL METRONOME //
//////////////////////
// Play click sound
function N(e,t=1e3){let o=u.createOscillator(),n=u.createGain();n.gain.value=e,o.frequency.value=t,o.connect(n),n.connect(u.destination),o.start(),o.stop(u.currentTime+.05)}async function C(){"suspended"===u.state&&await u.resume(),"running"!==Tone.context.state&&(await Tone.start(),console.log("Tone.js has started")),(I=!I)&&B(S.value)}async function B(t){"running"!==Tone.context.state&&await Tone.start(),Tone.Transport.bpm.value=t,e||(e=new Tone.Loop(e=>{I&&N(R.value,M),function(){console.log(`${v}/4`),M=1==(v=v%4+1)?1500:1e3;// const event = new Event('metronomeTick');
// window.dispatchEvent(event);
let e=new CustomEvent("metronomeTick",{detail:{tick:v}});window.dispatchEvent(e)}()},"4n")).start(0),Tone.Transport.start()}!//-------------------------------------
// Functions
//-------------------------------------
// startButton.addEventListener('click', function() {
//     initializeApp();
//     startButton.style.display = 'none'; // Hide the button after initialization
// });
async function(){// Set default BPM or retrieve it from a saved setting or slider
let e=S.value;// Indicate that the metronome is running
U=!0,console.log("App initialized!"),console.log("Default BPM:",e),console.log("Temperature value:",T),console.log("Hit tolerance:",y),console.log("Sampling strategy:",D.strategy[W])}(),// Variety knob
// TODO: WOrk on it more!
document.getElementById("temp").addEventListener("input",function(){let e=this.value;T=z(e,[0,1],D.tempRange[W]),document.getElementById("knob3Value").textContent=e,// TODO: Check if it's a good idea to combine the two values. If yes, check better ways of combining.
console.log("tempVal:",T)}),// Thresh knob
// TODO: WOrk on it more!
document.getElementById("tolerance").addEventListener("input",function(){let e=this.value;// tempVal = scaleValue(value, [0, 1], [0.01, 100]);
y=z(e,[0,1],D.threshRange[W]),document.getElementById("knob4Value").textContent=e,// TODO: Check if it's a good idea to combine the two values. If yes, check better ways of combining.
console.log("threshVal:",y)});var j={},q={};q=function(e,t,o){if(t===self.location.origin)// use the worker bundle's own url.
return e;// Otherwise, create a blob URL which loads the worker bundle with `importScripts`.
var n=o?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))};let G=new URL("workerAjax.6b1dfd8f.js",import.meta.url);j=q(G.toString(),G.origin,!0);// New Web Worker setup for client-server communication
const O=new Worker(j);// Modify `sendArrayToServer` to post data to the worker:
function P(e){O.postMessage({cmd:"sendArray",array:e,bpm:parseFloat(document.getElementById("tempo").value),temperatureValue:T,hitTolerance:y,isHttpConnected:!0,httpIp:"158.39.200.82",portInput:"5002",samplingStrategy:D.strategy[W]})}/// UTILS ///
// Scale a value from one range to another
function z(e,t,o){let n=(o[1]-o[0])/(t[1]-t[0]);return(Math.min(t[1],Math.max(t[0],e))-t[0])*n+o[0]}// Listen to messages from the worker:
O.addEventListener("message",function(e){let t=e.data;switch(console.log("Setting MIDI data, length:",t.length),t.type){case"arrayProcessed":// process the MIDI data as needed
console.log("MIDI data received in bytes!",t.data),H.setMidiData(t.data),// tappedRhythms = [];
k.length=0;break;case"error":console.error("Error from worker:",t.error)}}),//-------------------------------------
// Event Listeners
//-------------------------------------
// WITH THE OLD UI:
// Event listeners for the metronome
// toggleMetronomeButton.addEventListener('click', () => {
//     toggleMetronomeButton.classList.toggle('toggled');
//     toggleMetronome();
// });
// WITH THE NEW UI
// TODO: Fix it because it doesn't work properly while generating 
h.addEventListener("change",C),// Event listener for the tempo and vol sliders
S.addEventListener("input",function(){let e=this.value;document.getElementById("knob1Value").textContent=e,U&&B(e)}),R.addEventListener("input",function(){let e=this.value;document.getElementById("knob2Value").textContent=e;// Update the knob value
}),// Record tapped rhythm -- event listener for when the key "A" is pressed to start recording
window.addEventListener("keydown",e=>{if("a"===e.key&&!w){e.preventDefault(),A=!0,L=Date.now(),E.innerText="REC ON!",E.classList.add("recording");let t=parseInt(8)*parseInt(4);//.value methods removed for new UI
F=Array(t).fill(0),w=!0}if(" "===e.key&&A){//   playClick(tapVolumeSlider.value, 300);
N(R.value,300)// If same knob is used for both metronome and tap volume
;let e=Date.now()-L,t=parseInt(S.value),o=parseInt(4),n=Math.round(e/(6e4/(t*o)));n<F.length&&(F[n]=1),lastTapTimestamp=Date.now()}if(" "===e.key){e.preventDefault();let t=document.getElementById("tapLight");t.classList.remove("light-off"),t.classList.add("light-on")}if("T"===e.key.toUpperCase()){let e=new Date().getTime(),t=e-x,o=document.getElementById("tapTempoLight");if(o.classList.remove("light-off"),o.classList.add("light-on"),// tapTempoLight.style.backgroundColor = 'red';
N(R.value,1500),setTimeout(()=>{// tapLight.style.backgroundColor = '';
o.classList.remove("light-on"),o.classList.add("light-off")},100),0!==x){b.push(t),b.length>4&&b.shift();let e=b.reduce((e,t)=>e+t,0)/b.length,o=parseInt(6e4/e),n=document.getElementById("tempo"),r=document.getElementById("knob1Value"),i=document.getElementById("tempoSlider");n&&(n.value=o.toFixed(2)),r&&(r.innerText=o.toFixed(0)),i&&(i.value=o.toFixed(0))}x=e}}),// evet listener for when key "A" is released
window.addEventListener("keyup",e=>{if("a"===e.key&&(A=!1,E.innerText="REC OFF",E.classList.remove("recording"),function(e){let t=document.createElement("li");t.textContent=e.map(e=>0!==e?"1":"0").join(""),g.firstChild?g.insertBefore(t,g.firstChild):g.appendChild(t)}(F),P(F),U&&(// Toggle the metronome off
// toggleMetronome();
I=!1,h.checked=!1),w=!1)," "===e.key){let e=document.getElementById("tapLight");e.classList.remove("light-on"),e.classList.add("light-off")}}),// Incorporate the `change` action
// TODO: Make sure it works properly
document.getElementById("changeButton").addEventListener("click",function(){P(editedArray=function(e,t=1){// TODO: Implement this function to `change` action
/**
     * Toggle values in the input array at random indices.
     *
     * Parameters:
     * - arr (array-like): The input array containing only 0s and 1s.
     * - numIndices (int): The number of random indices to toggle (default is 1).
     *
     * Returns:
     * - Edited array with toggled values.
     */// Check if the input array is valid (contains only 0s and 1s)
if(!e.every(e=>0===e||1===e))throw Error("Input array must consist of only 0s and 1s.");// Create a copy of the input array to avoid modifying the original
let o=[...e],n=[];for(let o=0;o<t;o++){let t=Math.floor(Math.random()*e.length);n.push(t)}return(// Toggle the values at the selected indices
n.forEach(e=>{o[e]=1-o[e]}),o)}(F,numIndices=1))}),resetButton.addEventListener("click",()=>{g.innerHTML=""});var Y={};Y=new URL("A.1bc05b06.png",import.meta.url).toString();var K={};K=new URL("B.873f0259.png",import.meta.url).toString(),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("modelChangeButton");e.addEventListener("click",function(){let e=this.querySelector("img");e.src.includes(Y)?(e.src=K,W=1,console.log("Sampling changed to (B) Softmax!")):(e.src=Y,W=0,console.log("Model changed to (A) Epsilon!"))})});const J=document.getElementById("midi-btn");J.addEventListener("click",// Open the MIDI I/O popup
function(){window.open(src="","popup","width=450,height=450",sandbox="allow-popups")}//./../html/midi-io.html
);// Author: Çağrı Erdem, 2023
// Description: MIDI broadcasting script for 2groove web app.
const X=new(window.AudioContext||window.webkitAudioContext);let V=null,Q=[];// Start time for the MIDI playback
const Z=[];let $=null,ee=!1;// Play next MIDI in the queue and set it for visualization
function et(){// Only start playing the next MIDI if the current one has finished
!ee&&Z.length>0&&($=Z.shift(),Tone.Transport.start("@1m"),eo($))}// //Main function that is responsible of retrieving the MIDI bytes, converting them into a MIDI object, parsing it, and scheduling the notes
// //without Transport
async function eo(e){ee=!0,Q.forEach(clearTimeout),Q=[],currentNoteIndex=0,V=X.currentTime,currentTick=0;try{let n=new Midi(e);// Convert the raw data into a Midi object
o=e,// Adjust negative delta values
n.tracks.forEach(e=>{let t=0;e.notes.forEach(e=>{if(e.ticks<0)t+=e.ticks,e.ticks=0;else if(t<0){let o=Math.min(e.ticks,-t);// Calculate the possible adjustment
e.ticks-=o,t+=o}})}),console.log("Parsed MIDI:",n);let r=n.tracks[0];if(Tone.Transport.start(),!t){console.warn("MIDI output not available");return}let i=n.header.tempos&&n.header.tempos[0]?n.header.tempos[0].bpm:120,a=n.header.ppq,c=6e4/i/a;// Fallback to a default tempo if not defined ???
r.notes.forEach((e,o)=>{let n=e.ticks*c;e.ticks,// // Schedule a note to be played
// // without Transport
function(e,o,n){var r;let i;let a=(r=e.velocity,i=(0,(127-0)/1),(Math.min(1,Math.max(0,r))-0)*i+0),c=V+o/1e3,m=setTimeout(()=>{t.send([144,e.midi,a]),// console.log(`Note Number: ${note.midi}, Velocity: ${vel}, Scheduled Time: ${scheduledTime}`);
currentNoteIndex=n+1;// console.log(`${currentNoteIndex}: ${note.midi}, ${vel}`);
},(c-X.currentTime)*1e3);Q.push(m)}(e,n,o)});let m=r.durationTicks*c;r.durationTicks,console.log(`Total time: ${m} ms`),console.log(`Total transport time: ${r.durationTicks*c/1e3} s`),setTimeout(()=>{// Tone.Transport.stop();
ee=!1,Z.length>0?et():eo($)},m)}catch(e){console.error("Error processing MIDI data:",e.message)}}// TODO: play/pause button
// isPaused = false;
// const playPauseButton = document.getElementById('play-pause-btn');
// playPauseButton.addEventListener('click', () => {
//     isPaused = !isPaused;
//     if (isPaused) {
//         // If paused, clear all timeouts (stop all scheduled notes)
//         // timeouts.forEach(timeout => clearTimeout(timeout));
//     } else {
//         // When resumed, restart the MIDI playback from where we paused
//         // loadMidiData(currentMidiForVisuals);
//     }
// });
// TODO: Set up the main clock
// Set up an event listener for the tick event
window.addEventListener("metronomeTick",function(e){// currentTick++;
// console.log(`\rClick ${(currentTick%4)+1}/4`);
}),// MIDI initialization
navigator.requestMIDIAccess().then(function(e){let o=Array.from(e.outputs.values());if(0===o.length){console.warn("No MIDI outputs found");return}!function(e){let o=document.getElementById("midiOutputs");e.forEach((e,t)=>{let n=document.createElement("option");n.value=t,n.text=e.name,o.appendChild(n)}),o.addEventListener("change",o=>{t=e[o.target.value]}),t=e[0]}(o)},function(){console.error("Could not access your MIDI devices.")}),"suspended"===X.state&&X.resume(),// polling mechanism to regularly check globalFetch for new MIDI data:
setInterval(()=>{// Check for new MIDI data and enqueue it
(function(){if(H.isMidiReadyForProcessing()){let e=H.getMidiData().buffer;// convert to ArrayBuffer when fetching JSON
Z.push(e),H.midiProcessed(),ee||et()}})(),et()},500);const en=document.getElementById("download-btn");en.addEventListener("click",// Check every 500 milliseconds. Adjust this value as necessary
//  document.getElementById('play-pause-btn').addEventListener('click', function() {
//     /// play pause button
//     console.log("Play/pause button clicked but not working yet :))");
// });
// Download the processed MIDI data
function(){if(!o){console.error("No MIDI data available for download.");return}let e=new Blob([o],{type:"audio/midi"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="2groove_gen.mid",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}),// Run the sketch:
new p5(e=>{// MIDI Handling
e.loadMidiFile=function(t){let o=t.target.files[0];if(o){let t=new FileReader;// Removed s. prefix
t.onload=function(t){let o=t.target.result;e.parseMidi(o);// Removed s. prefix from arrayBuffer
},t.readAsArrayBuffer(o)}},// MIDI parse function without quantization
e.parseMidi=function(t,o=!1){// Preliminary check for unexpected data format
if("string"==typeof t&&t.startsWith("<!do")){console.error("Received unexpected HTML data instead of MIDI");return;// exit function early
}try{let n=new Midi(t);// Assuming that `new Midi` can handle the raw arrayBuffer
// Adjust negative delta values
n.tracks.forEach(e=>{let t=0;e.notes.forEach(e=>{if(e.ticks<0)t+=e.ticks,e.ticks=0;else if(t<0){let o=Math.min(e.ticks,-t);// Calculate the possible adjustment
e.ticks-=o,t+=o}})}),e.noteSequences=n.tracks.map(e=>(o&&e.notes.forEach(e=>{console.log(e)}),{notes:e.notes.map(e=>({pitch:e.midi,startTime:e.time,endTime:e.time+e.duration,velocity:e.velocity// Include velocity in the note object
        }))}))}catch(e){console.error("Error processing MIDI data in pRoll.js:",e.message)}},// s.parseMidi = function(arrayBuffer, verbose = false) { 
//     const midi = new Midi(arrayBuffer);  // Removed s. prefix
//     s.noteSequences = midi.tracks.map(track => {
//         return { notes: track.notes.map(note => {
//             if (verbose){
//                 track.notes.forEach(note => {
//                     console.log(note);
//                 })}; 
//             return {
//                 pitch: note.midi,
//                 startTime: note.time,
//                 endTime: note.time + note.duration,
//                 velocity: note.velocity // Include velocity in the note object
//             };
//         })};
//     });
// }
// Constants and global variables
e.NUM_STEPS=32,e.SUBDIVISIONS=4,e.NUM_NOTES=20,e.LOWEST_MIDI_NOTE=34,e.noteSequences,e.resizingWidth=!1,e.resizingHeight=!1,e.WIDTH=550,e.HEIGHT=250,e.EDGE_THRESHOLD=10,e.offset_x=1.3,e.offset_y=1.5,e.drumMappings={35:"acoustic bass drum",36:"kick",37:"side-stick",38:"snare",39:"clap",40:"electric snare",41:"floor-tom",42:"closed-hihat",43:"high-tom",44:"pedal-hihat",45:"low-tom",46:"open-hihat",47:"mid-tom",48:"hi-tom",49:"crash",50:"high-tom",51:"ride",52:"chinese cymbal"},// Functions
e.setup=function(){e.createCanvas(e.WIDTH,e.HEIGHT).parent("pianoRollContainer");// pRollCanvas.parent('pianoRollContainer'); // attach to the specific div
// file input //no file input with the new UI
// const midiInput = document.getElementById('fileInput'); // Get the input element by its ID
// midiInput.addEventListener('change', s.loadMidiFile); // Add an event listener for when a user selects a file
// // fetch button
// let fetchButton = s.createButton('Fetch MIDI Data');
// fetchButton.mousePressed(s.triggerMidiFetch); 
},e.draw=function(){e.background("#fae"),e.tappedRhythm=F;// Fetch MIDI data from the server
let t=$;t&&e.parseMidi(t);var o=0+e.offset_x,n=0+e.offset_y;// var y = s.HEIGHT - s.WIDTH;
e.drawTappedRhythm(e.tappedRhythm,o,n,e.WIDTH,e.WIDTH),e.noteSequences&&e.drawNotes(e.noteSequences[0].notes,o,n,e.WIDTH,e.WIDTH),e.fill(255,64),// Draw vertical lines for subdivisions
e.stroke("white");let r=e.WIDTH/(e.NUM_STEPS/4*e.SUBDIVISIONS);for(let t=0;t<e.WIDTH;t+=r)e.line(t+e.offset_x,0,t+e.offset_x,e.HEIGHT);// Draw vertical lines for beats
e.stroke("rgba(0,255,0,0.25)"),e.strokeWeight(1.2);let i=e.WIDTH/(e.NUM_STEPS/4);for(let t=0;t<e.WIDTH;t+=i)e.line(t+e.offset_x,0,t+e.offset_x,e.HEIGHT);// Draw vertical lines for bars
e.stroke("rgb(0,255,0)"),e.strokeWeight(.8);let a=e.WIDTH/(e.NUM_STEPS/16);for(let t=0;t<e.WIDTH;t+=a)e.line(t+e.offset_x,0,t+e.offset_x,e.HEIGHT);e.showPopup()},// Draw function for quantized tapped rhythm 
e.drawTappedRhythm=function(t,o,n,r,i){let a=t.length;e.push(),e.translate(o,n);var c=r/a,m=i/e.NUM_NOTES;t.forEach(function(t,o){if(1===t){var n=e.color(219,247,19,120);// Less opaque
e.fill(n),e.rect(c*o,0,c,m)}}),e.pop()},// Draw function without quantization
e.drawNotes=function(t,o,n,r,i){let a=e.noteSequences.reduce((e,t)=>{let o=t.notes.map(e=>e.endTime);return Math.max(e,...o)},0);e.push(),e.translate(o,n);var c=e.WIDTH/a,m=e.HEIGHT/e.NUM_NOTES;// Update cellWidth based on the new width
t.forEach(function(t){var o=e.color(255,0,191,255*t.velocity);e.stroke("black"),e.strokeWeight(.6),e.fill(o),e.rect(10+c*t.startTime,e.HEIGHT-m*(t.pitch-e.LOWEST_MIDI_NOTE),c*(t.endTime-t.startTime)-10,m)}),e.pop()},// For example:
e.mousePressed=function(){e.abs(e.mouseX-e.WIDTH)<e.EDGE_THRESHOLD&&(e.resizingWidth=!0),e.abs(e.mouseY-e.HEIGHT)<e.EDGE_THRESHOLD&&(e.resizingHeight=!0)},e.mouseDragged=function(){e.resizingWidth&&(e.WIDTH=e.mouseX),e.resizingHeight&&(e.HEIGHT=e.mouseY),// Apply the new width and height to the canvas
e.resizeCanvas(e.WIDTH,e.HEIGHT)},e.mouseReleased=function(){// Reset resizing flags
e.resizingWidth=!1,e.resizingHeight=!1},e.showPopup=function(){if(e.mouseX>e.offset_x&&e.mouseX<e.WIDTH+e.offset_x&&e.mouseY>0&&e.mouseY<e.HEIGHT){let t=e.HEIGHT/e.NUM_NOTES,o=Math.floor((e.HEIGHT-e.mouseY)/t),n=parseInt(Object.keys(e.drumMappings)[o]);if(n>=e.LOWEST_MIDI_NOTE&&35!=n){let t=e.drumMappings[n],o=e.textWidth(t)+10,r=e.mouseX+5;e.mouseX>(e.WIDTH+e.offset_x)/2&&(r=e.mouseX-o-5),e.fill(255),e.rect(r,e.mouseY,o,20),e.fill(0),e.text(t,r+5,e.mouseY+15)}}}}),// worker for client-side ajax requests
self.addEventListener("message",function(e){let t=e.data;"sendArray"===t.cmd&&// function sendArrayToServer(array, bpm, temperatureValue, hitTolerance, isHttpConnected, httpIp, portInput, samplingStrategy) {
//     if (!isHttpConnected) return;
//     const data_url = `http://${httpIp}:${portInput}/send_array`;
//     console.log("Sending request to:", data_url);
//     const payload = {
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json'
//         },
//         body: JSON.stringify({
//             array: array,
//             bpm: bpm,
//             temp: temperatureValue,
//             thresh: hitTolerance,
//             samplingStrategy: samplingStrategy
//         })
//     };
//     fetch(data_url, payload)
//     .then(response => response.arrayBuffer())
//     .then(data => {
//         console.log("Processing tapped rhythms...");
//         // send a message back to the main thread if necessary
//         self.postMessage({type: 'arrayProcessed', data: data});
//     })
//     .catch(error => {
//         console.error("Error:", error);
//         self.postMessage({type: 'error', error: error});
//     });
// }
function(e,t,o,n,r,i,a,c){if(!r)return;let m=`http://${i}:${a}/send_array`;console.log("Sending request to:",m);let _={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({array:e,bpm:t,temp:o,thresh:n,samplingStrategy:c})};fetch(m,_).then(e=>e.json())// Process as JSON first
// checking the success field of the response, and if it's true, you're converting the data field (base64 encoded string of the MIDI binary) 
// back to a byte array, and then you're posting this byte array back to the main thread:
.then(e=>{if(e.success){console.log("Processing tapped rhythms...");// const midiData = new Uint8Array(data.data);  // Convert base64 string to byte array
let t=atob(e.data),o=new Uint8Array(t.length).map((e,o)=>t.charCodeAt(o));console.log("Received MIDI data length:",o.length),self.postMessage({type:"arrayProcessed",data:o})}else console.warn(e.message),self.postMessage({type:"error",error:Error(e.message)})}).catch(e=>{console.error("Error:",e),self.postMessage({type:"error",error:e})})}(t.array,t.bpm,t.temperatureValue,t.hitTolerance,t.isHttpConnected,t.httpIp,t.portInput,t.samplingStrategy)});// dedicated thread for queueing up rhythms
let er=[];// This will hold the queued MIDI events
self.addEventListener("message",function(e){let t=e.data;switch(t.cmd){case"enqueue":er.push(t.event);break;case"dequeue":// Logic to decide which event(s) should be sent next
let o=er.shift();// Simplified example
self.postMessage({cmd:"broadcast",event:o})}});// ----------------------------
// ----------------------------
//# sourceMappingURL=index.b186437a.js.map

//# sourceMappingURL=index.b186437a.js.map
